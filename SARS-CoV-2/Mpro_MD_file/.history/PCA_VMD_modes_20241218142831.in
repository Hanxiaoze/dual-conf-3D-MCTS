parm p_l_wat.prmtop [pppp]
trajin prod1.nc
trajin prod2.nc
trajin prod3.nc
trajin prod4.nc
trajin prod5.nc
rms first :1-306&!@H=
average crdset crd-average
createcrd nc-whole
run
crdaction nc-whole rms ref crd-average :1-306&!@H=
crdaction nc-whole matrix covar \
name nc-covar :1-306&!@H=
runanalysis diagmatrix nc-covar out nc-evecs.dat \
vecs 3 name myEvecs \
nmwiz nmwizvecs 3 nmwizfile nc.nmd nmwizmask :1-306&!@H=
crdaction nc-whole projection pppp modes myEvecs \
beg 1 end 3 :1-306&!@H= crdframes 1,2500
hist pppp:1 bins 100 out nc-hist.agr norm name nc-1
hist pppp:2 bins 100 out nc-hist.agr norm name nc-2
hist pppp:3 bins 100 out nc-hist.agr norm name nc-3
run
clear all
readdata nc-evecs.dat name Evecs
parm p_l_wat.prmtop
parmstrip !(:1-306&!@H=)
parmwrite out nc-modes.prmtop
runanalysis modes name Evecs trajout nc-mode1.nc \
pcmin -100 pcmax 100 tmode 1 trajoutmask :1-306&!@H= trajoutfmt netcdf
runanalysis modes name Evecs trajout nc-mode2.nc \
pcmin -100 pcmax 100 tmode 2 trajoutmask :1-306&!@H= trajoutfmt netcdf
runanalysis modes name Evecs trajout nc-mode3.nc \
pcmin -100 pcmax 100 tmode 3 trajoutmask :1-306&!@H= trajoutfmt netcdf
run
quit
